<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />

        <!-- Built with RPD v0.2.0-alpha <http://shamansir.github.io/rpd> -->

        <!-- gulp ==renderer svg ==style compact-v ==toolkit core ==target-name rpd ==compilation simple -->

        <!-- RPD Renderer: svg -->
        <link rel="stylesheet" href="../src/render/svg.css"></style>
        <!-- RPD Style: compact-v (svg) -->
        <link rel="stylesheet" href="../src/style/compact-v/svg.css"></style>
        <!-- RPD Toolkit: core (svg) -->
        <link rel="stylesheet" href="../src/toolkit/core/svg.css"></style>

        <!-- Kefir -->
        <script src="../vendor/kefir.min.js"></script>
        <!-- RPD -->
        <script src="../src/rpd.js"></script>

        <!-- RPD's d3_tiny.js -->
        <script src="../src/d3_tiny.js"></script>
        <!-- RPD Rendering Engine: -->
        <script src="../src/render/shared.js"></script>
        <!-- RPD Style: compact-v (svg) -->
        <script src="../src/style/compact-v/svg.js"></script>
        <!-- RPD Renderer: svg -->
        <script src="../src/render/svg.js"></script>
        <!-- RPD Toolkit: core -->
        <script src="../src/toolkit/core/shared.js"></script>
        <script src="../src/toolkit/core/toolkit.js"></script>
        <!-- RPD Toolkit: core (svg) -->
        <script src="../src/toolkit/core/svg.js"></script>

        <style>
            .rpd-node .rpd-header {
                fill: rgba(160,107,154,0.95);
            }

            .rpd-node .rpd-content {
                fill: rgba(141,158,198,0.9);
            }

            /* 203, 118, 158 */
            /* 224, 152, 145 */
            /* 232, 185, 171 */
            /* 215, 192, 208 */
            /* 124, 132, 131 */
            /* 172, 221, 231 */
            /* 154, 213, 202 */

            .rpd-node .rpd-shadow {
                opacity: 0.3;
                fill: rgb(172, 221, 231);
            }
        </style>

    </head>

    <body>

        <canvas id="target"></canvas>

        <script>
            Rpd.renderNext('svg', document.body, { style: 'compact-v' });

            var patch = Rpd.addPatch('Docs Patch');

            patch.addNode('core/empty', 'Empty');

            function start(ctx) {
                var duration = 3;
                var firstRender;

                var width = 500;
                var height = 100;

                var planets = [
                    { name: "Sun", size: 109.3, opacity: 0 },
                    { name: "Mercury", size: 0.3829, opacity: 0 }, /*1*/
                    { name: "Venus", size: 0.9499, opacity: 0 },   /*2*/
                    { name: "Earth", size: 1.0, opacity: 1 },      /*3*/
                    { name: "Mars", size: 0.5320, opacity: 0 },    /*4*/
                    { name: "Jupiter", size: 10.97, opacity: 1 },  /*5*/
                    { name: "Saturn", size: 9.140, opacity: 0 },   /*6*/
                    { name: "Uranus", size: 3.981, opacity: 0 },   /*7*/
                    { name: "Neptune", size: 3.865, opacity: 0 }   /*8*/
                    //{ name: "Pluto", size: 0.186 }     /*9*/
                ];

                var BASE_SIZE = height / planets[0].size * 6.2;
            //var BASE_SIZE = height / planets[5].size * 0.9;

                function draw() {
                    if (!firstRender) firstRender = new Date().getTime();
                    ctx.save();
                    ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
                    ctx.clearRect(0, 0, width, height);
                	var passed = (new Date().getTime() - firstRender) / 1000;
                	if (passed > duration) passed = duration;

                    planets.forEach(function(planet, i) {
                		var targetPos = (width / (planets.length - 1)) * i;
            		    var opacity = planet.opacity || (passed / duration);
            		    ctx.beginPath();
                  	    ctx.arc(targetPos * (passed / duration), height / 2, (planet.size * BASE_SIZE) / 2, 0, 2 * Math.PI, false);
                  	    ctx.fillStyle = 'rgba(0,128,0,' + opacity + ')';
                  	    ctx.fill();
            	        //ctx.lineWidth = 5;
                  	    //ctx.strokeStyle = '#003300';
                  	    ctx.stroke();
            	    });

            	    ctx.font = "bold italic 10px Verdana";
            	    ctx.fillStyle = 'rgba(0,0,0,1.0)';
            	    ctx.fillText(BASE_SIZE + " " + passed,0,10);

            	    ctx.strokeRect(0, 0, width, height);

                    ctx.restore();
                    requestAnimationFrame(draw);

                };

                return draw;
            }

            function runAnimation() {
                var ctx = document.getElementById('target').getContext('2d');
                var draw = start(ctx);
                requestAnimationFrame(draw);
            }

            //runAnimation();
        </script>
    </body>
</html>
