<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Core with Network</title>

        <!-- Style CSS -->
        <link rel="stylesheet" href="../src/render/style/pd/html.css"></style>
        <!-- Renderer CSS -->
        <link rel="stylesheet" href="../src/render/html.css"></style>
        <!-- Toolkits Renderers CSS -->
        <link rel="stylesheet" href="../src/toolkit/core/render/html.css"></link>

        <!-- Kefir -->
        <script src="../vendor/kefir.min.js"></script>

        <!-- RPD -->
        <script src="../src/rpd.js"></script>

        <!-- Import/Export -->
        <script src="../src/io/json.js"></script>

        <!-- D3.js or D3_tiny.js -->
        <script src="../src/render/d3_tiny.js"></script>

        <!-- Style JS -->
        <script src="../src/render/style/pd/html.js"></script>
        <!-- Renderer JS -->
        <script src="../src/render/html.js"></script>

        <!-- Toolkits JS -->
        <script src="../src/toolkit/core/toolkit.js"></script>
        <!-- Toolkits Renderers JS -->
        <script src="../src/toolkit/core/render/html.js"></script>

    </head>

    <body>

        <script>
            var finalize = Rpd.export.json('Core with Network');

            Rpd.render('html', document.body, { style: 'pd' });

            var root = Rpd.addPatch('root').enter();

            var genA = root.addNode('core/custom', 'Generate A');
            var outA = genA.addOutlet('core/number', 'A');

            var genA = root.addNode('core/custom', 'Generate B');
            var outB = genA.addOutlet('core/number', 'B', '', 1);

            var test = root.addNode('core/sum-of-three', 'foo')
            test.addInlet('core/number', 'D');
            test.addInlet('core/number', 'E');
            test.addOutlet('core/number', 'F');

            var sum = Rpd.addPatch('sum');

            var sumOfThree1 = sum.addNode('core/sum-of-three', 'Sum1');
            var in1A = sumOfThree1.inlets['a'];
            var in1B = sumOfThree1.inlets['b'];
            var sum1 = sumOfThree1.outlets['sum'];

            var sumOfThree2 = sum.addNode('core/sum-of-three', 'Sum2');
            var in2A = sumOfThree2.inlets['a'];
            var sum2 = sumOfThree2.outlets['sum'];

            sum1.connect(in2A);

            sum.inputs([ in1A, in1B ]);
            sum.outputs([ sum2, sum1 ]);

            //root.connect(sum);

            // var p = root.addNode('core/model-ref', 'SumPatch');
            // p.inlets['model'].receive(sum);

            var p = root.addNode('core/custom');
            sum.project(p);

            //outB.connect(p.inlets['a']);

            //outA.stream(Kefir.repeatedly(10, [1, 2, 3]));
            //outB.stream(Kefir.repeatedly(20, [4, 5, 6]));

            console.log(finalize());

        </script>
    </body>
</html>
